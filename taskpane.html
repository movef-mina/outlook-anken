<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>kintoneæ¡ˆä»¶é€£æº</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    select, button { margin-top: 10px; padding: 5px; font-size: 14px; }
  </style>
</head>
<body>
  <h2>kintoneæ¡ˆä»¶ã‚’ãƒ¡ãƒ¼ãƒ«ã«ç´ã¥ã‘</h2>
  <label for="projectSelect">æ¡ˆä»¶ã‚’é¸æŠ:</label><br>
  <select id="projectSelect">
    <option value="1234">ã€1234ã€‘é¡§å®¢A - ãƒ†ã‚¹ãƒˆæ¡ˆä»¶</option>
    <option value="5678">ã€5678ã€‘é¡§å®¢B - å®Ÿè¨¼æ¡ˆä»¶</option>
  </select><br>
  <button onclick="saveAnken()">ğŸ“ ãƒ¡ãƒ¼ãƒ«ã«ç´ã¥ã‘ã‚‹</button>
  <p id="statusMessage"></p>

  <script>
    Office.onReady(function(info) {
      if (info.host === Office.HostType.Outlook) {
        document.getElementById('statusMessage').textContent = 'ãƒ¡ãƒ¼ãƒ«ä½œæˆä¸­ã®Outlookã§å‹•ä½œä¸­';
      }
    });

    function saveAnken() {
      const ankenId = document.getElementById('projectSelect').value;
      Office.context.mailbox.item.internetHeaders.setAsync(
        'X-KINTONE-ANKEN-ID',
        ankenId,
        function (asyncResult) {
          const msg = asyncResult.status === "succeeded"
            ? "âœ… æ¡ˆä»¶ID " + ankenId + " ã‚’ãƒ¡ãƒ¼ãƒ«ã«ç´ã¥ã‘ã¾ã—ãŸ"
            : "âŒ æ¡ˆä»¶ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ";
          document.getElementById('statusMessage').textContent = msg;
        }
      );
    }
  </script>
</body>
</html>
